<?

include (\Util::getDocumentRoot()."system/legacy/admin/includes/main.inc.php");

Access_Backend::checkAccess("modules_admin");

?>

<?=Admin_Html::loadAdminHeader()?>

<?

if($_POST['action'] == "config") {
	$config = new \Cms\Helper\ExtensionConfig($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id'], $_VARS['language']);
	$config->idTable 		= $_VARS['idTable'];
	$config->error_nodata 	= $_VARS['error_nodata'];
	$config->error_noentry 	= $_VARS['error_noentry'];
	$config->emailsubject 	= $_VARS['emailsubject'];
	$config->emailcontent 	= $_VARS['emailcontent'];
	$config->optinsubject 	= $_VARS['optinsubject'];
	$config->optincontent 	= $_VARS['optincontent'];

	$config->save_config($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id']);
}
?>

<table cellpadding="0" cellspacing="30" border="0" width="100%" height="100%">
	<tr>
		<td valign="top">
			<h1>Kundendatenmodul &raquo; Passwort vergessen</h1>
			<p>
<?

$config = new \Cms\Helper\ExtensionConfig($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id'], $_VARS['language']);

if ($_VARS['page_id'] && $_VARS['element_id'] && $_VARS['content_id']) {
?>
			<form method="POST" action="customer_db_sendpw.html">
			<input type="hidden" name="action" value="config">
			<input type="hidden" name="page_id" value="<?=$_VARS['page_id']?>">
			<input type="hidden" name="element_id" value="<?=$_VARS['element_id']?>">
			<input type="hidden" name="content_id" value="<?=$_VARS['content_id']?>">
			<?=printTableStart()?>
			<?=printFormSelect("Kundendatenbank", "idTable",CustomerDb\Helper\Functions::getCustomerTables(),$config->idTable)?>
			<?=printFormText("Fehlermeldung: keine Angabe", "error_nodata",$config->error_nodata)?>
			<?=printFormText("Fehlermeldung: nicht gefunden", "error_noentry",$config->error_noentry)?>
			<?=printFormText("Opt-in: E-Mail Betreff","optinsubject",$config->optinsubject)?>
			<?=printFormTextarea("Opt-in: E-Mail Inhalt","optincontent",$config->optincontent)?>
			<?=printFormText("Neue Daten: E-Mail Betreff","emailsubject",$config->emailsubject)?>
			<?=printFormTextarea("Neue Daten: E-Mail Inhalt","emailcontent",$config->emailcontent)?>
			<?=printTableEnd()?>
			<?=printSubmit("Konfiguration speichern")?>
			</form>		
			<p>
			Platzhalter:<br>
			{$nickname}, {$email}, {$password}, {$get_new_password}
			</p>
<?
}
?>
		</td>
	</tr>
</table>
<?=Admin_Html::loadAdminFooter()?>