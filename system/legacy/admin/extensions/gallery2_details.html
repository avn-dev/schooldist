<?

include("../includes/main.inc.php");

Access_Backend::checkAccess("modules_admin");

?>

<?=Admin_Html::loadAdminHeader()?>

<table cellpadding="0" cellspacing="30" border="0" width="100%">
	<tr>
		<td valign="top">
			<h1>Bildergalerie v2</h1>

<?

if ($_VARS['page_id'] && $_VARS['element_id'] && $_VARS['content_id']) {

	if ($_POST['action'] == "config") {
		$config = new \Cms\Helper\ExtensionConfig($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id'], $_VARS['language']);
		$config->gallery_id = $_VARS['gallery_id'];
		$config->repeat_x = $_VARS['repeat_x'];
		$config->repeat_y = $_VARS['repeat_y'];
		$config->save_config($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id']);
	}
	$config = new \Cms\Helper\ExtensionConfig($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id'], $_VARS['language']);

	$aGalleries = array(""=>"Auswahl per GET-Parameter");
	$res = db_query($db_data['module'],"SELECT * FROM `gallery2_list` WHERE `active`='1' ORDER BY name");
	while($my = get_data($res)) {
		$aGalleries[$my['id']] = $my['name'];
	}
?>
			<form method="post" action="<?=$_SERVER['PHP_SELF']?>">
			<input type="hidden" name="action" value="config">
			<input type="hidden" name="page_id" value="<?=$_VARS['page_id']?>">
			<input type="hidden" name="element_id" value="<?=$_VARS['element_id']?>">
			<input type="hidden" name="content_id" value="<?=$_VARS['content_id']?>">
			<?=printTableStart()?>
			<?=printFormSelect("Bildergalerie", "gallery_id", $aGalleries, $config->gallery_id)?>
			<?=printFormText("Bilder pro Zeile", "repeat_x", $config->repeat_x)?>
			<?=printFormText("Zeilen pro Seite", "repeat_y", $config->repeat_y)?>
			<?=printTableEnd()?>
			<?=printSubmit("Konfiguration speichern")?>
			</form>
<?
}
?>

		</td>
	</tr>
</table>
<?=Admin_Html::loadAdminFooter()?>
