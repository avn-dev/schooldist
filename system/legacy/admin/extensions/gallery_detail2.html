<?php

include("../includes/main.inc.php");

Access_Backend::checkAccess("modules_admin");

echo Admin_Html::loadAdminHeader();

?>

<style>
.newfolder {
	border-bottom: 1px solid black;
	border-right: 1px solid black;
	border-top: 1px solid black;
	border-left: 1px solid black;
}
.select_on {
	background-color: buttonface;
	border-bottom: 1px solid buttonhighlight;
	border-right: 1px solid buttonhighlight;
	border-top: 1px solid buttonshadow;
	border-left: 1px solid buttonshadow;
} 
.select_off {
	background-color: buttonface;
	border-top: 1px solid buttonhighlight;
	border-left: 1px solid buttonhighlight;
	border-bottom: 1px solid buttonshadow;
	border-right: 1px solid buttonshadow;
}
</style>
<script>

var folder = "<? echo $folder; ?>";
/**
 * Sets/unsets the pointer in browse mode
 *
 * @param   object   the table row
 * @param   object   the color to use for this row
 * @param   object   the background color
 *
 * @return  boolean  whether pointer is set or not
 */
var delete_media = new Array();
 
function setPointer(theRow, e, thePointerColor, theNormalBgColor)
{
if(!e.ctrlKey) {

for (var i=0;i<document.getElementsByTagName("tr").length;i++) {
var a = eval("document.getElementsByTagName('tr')["+i+"];");
if(a.id != "") {
////////////////////////////////////////////////////////////////////////////////////////
    var theCells = null;

    if (thePointerColor == '' || typeof(a.style) == 'undefined') {
        return false;
    }
    if (typeof(document.getElementsByTagName) != 'undefined') {
        theCells = a.getElementsByTagName('td');
    }
    else if (typeof(theRow.cells) != 'undefined') {
        theCells = a.cells;
    }
    else {
        return false;
    }
    var rowCellsCnt  = theCells.length;
    var currentColor = null;
    var newColor     = null;
	var newTextColor = 'HIGHLIGHTTEXT';
    // Opera does not return valid values with "getAttribute"
		currentColor = theCells[0].getAttribute('bgcolor');
        newColor     = theNormalBgColor;
        newTextColor = 'INFOTEXT';
        delete_media[a.id] = '0';
        //delete_media[theRow.id] = (currentColor.toLowerCase() == thePointerColor.toLowerCase())

		
        for (var c = 0; c < rowCellsCnt; c++) {
            theCells[c].setAttribute('bgcolor', newColor, 0);
			theCells[c].style.color = newTextColor;
        } // end for
////////////////////////////////////////////////////////////////////////////////////////		
}
}
}
    var theCells = null;

    if (thePointerColor == '' || typeof(theRow.style) == 'undefined') {
        return false;
    }
    if (typeof(document.getElementsByTagName) != 'undefined') {
        theCells = theRow.getElementsByTagName('td');
    }
    else if (typeof(theRow.cells) != 'undefined') {
        theCells = theRow.cells;
    }
    else {
        return false;
    }
    var rowCellsCnt  = theCells.length;
    var currentColor = null;
    var newColor     = null;
	var newTextColor = 'HIGHLIGHTTEXT';
    // Opera does not return valid values with "getAttribute"
		currentColor = theCells[0].getAttribute('bgcolor');
        newColor     = (currentColor.toLowerCase() == thePointerColor.toLowerCase())
                     ? theNormalBgColor
                     : thePointerColor;
        newTextColor     = (currentColor.toLowerCase() == thePointerColor.toLowerCase())
                     ? 'INFOTEXT'
                     : 'HIGHLIGHTTEXT';
        delete_media[theRow.id] = (currentColor.toLowerCase() == thePointerColor.toLowerCase())
                     ? 0
                     : 1;
        for (var c = 0; c < rowCellsCnt; c++) {
            theCells[c].setAttribute('bgcolor', newColor, 0);
			theCells[c].style.color = newTextColor;
        } // end for

    return true;
} // end of the 'setPointer()' function

function upd_form_data(id){
	parent.document.gallery_form_1.gallery_id.value = id;
}

</script>



<table cellpadding="1" cellspacing="0" border="0" width="100%" style="table-layout : fixed;">
<tr style="cursor:pointer;">
<td width=80% class=select_off>Seite</td>
<td width=20% class=select_off>Anzahl aktive Bilder</td>
</tr>
<?

//Daten holen
$rGalleries = DB::getQueryRows("SELECT * FROM gallery_init WHERE 1 ORDER BY name");
foreach($rGalleries as $aGalleries) {
	$down_abfrage3 = (array)DB::getQueryRows("SELECT id FROM gallery_data WHERE gallery_id = ".(int)$aGalleries['id']." AND active = '1'");
	$down_anzahl = count($down_abfrage3);

	//ListeneintrÃ¤ge erzeugen
	echo "<tr style=\"cursor:default;\" id=\"".$aGalleries['id']."\" onclick=\"setPointer(this, event, 'ACTIVECAPTION', '#FFFFFF'); upd_form_data('".$aGalleries['id']."');\">";
	echo "<td nowrap>".$aGalleries['name']."</td>";
	echo "<td nowrap>".$down_anzahl."</td>";
	echo "</tr>";
	unset($down_array2);
	unset($down_anzahl);
}//while

?>
</tr></table>
<?=Admin_Html::loadAdminFooter()?>
