<?php
// Includes
include("../includes/main.inc.php");

Access_Backend::checkAccess("modules_admin");

?>

<?=Admin_Html::loadAdminHeader()?>

<table cellpadding="0" cellspacing="30" border="0" width="100%">
	<tr>
		<td valign="top">
			<h1>Gaestebuch Administration</h1>
<?

if($_VARS['page_id'] && $_VARS['element_id']) {

	if($_VARS['action'] == "config") {
		$config = new \Cms\Helper\ExtensionConfig($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id'], $_VARS['language']);
		$config->email_add = 		$_VARS['email_add'];
		$config->email_from = 		$_VARS['email_from'];
		$config->email_subject = 	$_VARS['email_subject'];
		$config->email_body = 		$_VARS['email_body'];
		$config->per_page = 		$_VARS['per_page'];
		$config->name_needed = 		$_VARS['name_needed'];
		$config->mail_needed = 		$_VARS['mail_needed'];
		$config->captcha_needed = 	$_VARS['captcha_needed'];
		$config->sCapBgColor = 		$_VARS['sCapBgColor'];
		$config->sCapBorderColor = 	$_VARS['sCapBorderColor'];
		$config->sCapLen = 			$_VARS['sCapLen'];
		$config->sCapWidth = 		$_VARS['sCapWidth'];
		$config->sCapHeight = 		$_VARS['sCapHeight'];
		$config->save_config($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id']);

	}
	$config = new \Cms\Helper\ExtensionConfig($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id'], $_VARS['language']);

?>
			<form method="POST" action="guestbook.html">
			<input type="hidden" name="action" value="config">
			<input type="hidden" name="page_id" value="<?=$_VARS['page_id']?>">
			<input type="hidden" name="element_id" value="<?=$_VARS['element_id']?>">
			<input type="hidden" name="content_id" value="<?=$_VARS['content_id']?>">
			<?=printTableStart()?>
			<?=printFormText("eMail-Adresse zur Benachrichtigung",				"email_add", 		$config->email_add);?>
			<?=printFormText("eMail-Absender zur Benachrichtigung",				"email_from", 		$config->email_from);?>
			<?=printFormText("eMail-Betreff zur Benachrichtigung",				"email_subject", 	$config->email_subject);?>
			<?=printFormTextarea("eMail-Text-Template zur Benachrichtigung<br>" .
								"&lt;#time#&gt;, &lt;#date#&gt;, &lt;#text#&gt;, " .
								"&lt;#name#&gt;, &lt;#email#&gt;, &lt;#ip#&gt;", 				"email_body", $config->email_body);?>
			<?=printFormText("Eintr&auml;ge pro Seite",							"per_page", 		$config->per_page);?>
			<?=printFormSelect("Pflichtfeld: Name",								"name_needed", 		array(1=>'ja', 0=>'nein'),	$config->name_needed);?>
			<?=printFormSelect("Pflichtfeld: eMail",							"mail_needed", 		array(1=>'ja', 0=>'nein'),	$config->mail_needed);?>
			<?=printFormSelect("Pflichtfeld: Captcha (Code-Grafik)",			"captcha_needed", 	array(1=>'ja', 0=>'nein'),	$config->captcha_needed);?>
			<?=printFormText("Captcha: Hintergrundfarbe (z.B. ffffff entspricht z.B. wei&szlig;)",
																				"sCapBgColor", 		$config->sCapBgColor);?>
			<?=printFormText("Captcha: Rahmenfarbe (z.B. 000000 entspricht z.B. schwarz)",
																				"sCapBorderColor", 	$config->sCapBorderColor);?>
			<?=printFormText("Captcha: Anzahl der PrÃ¼fziffern",					"sCapLen", 			$config->sCapLen);?>
			<?=printFormText("Captcha: Breite der Code-Grafik",					"sCapWidth", 		$config->sCapWidth);?>
			<?=printFormText("Captcha: H&ouml;he der Code-Grafik",				"sCapHeight", 		$config->sCapHeight);?>

			<?=printTableEnd()?>

			<?=printSubmit("Konfiguration speichern")?>
			</form>
<?
} else {
?>
			Die Einstellungen der G&auml;steb&uuml;cher werden in den Seitenkonfigurationen verwaltet.
<?
}
?>
		</td>
	</tr>
</table>
<?=Admin_Html::loadAdminFooter()?>