<?php

// =============== Header ===============
require_once(Util::getDocumentRoot()."system/legacy/admin/includes/main.inc.php");
include_once(\Util::getDocumentRoot()."system/includes/gui/gui.php");
include_once(\Util::getDocumentRoot()."system/includes/class.pagetemplate.php");

Access_Backend::checkAccess("modules_admin");

if(
	isset($_VARS['page_id']) &&
	isset($_VARS['element_id']) &&
	isset($_VARS['content_id'])
) {

	if($_VARS['action'] == "config") {
		$oConfig = new \Cms\Helper\ExtensionConfig($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id'], $_VARS['language']);
		$oConfig->type = $_VARS['type'];
		$oConfig->email_text = $_VARS['email_text'];
		$oConfig->save_config($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id']);
	}
	$oConfig	= new \Cms\Helper\ExtensionConfig($_VARS['page_id'], $_VARS['element_id'], $_VARS['content_id'], $_VARS['language']);

	$objPage	= new GUI_Page();
	$objPage->appendElement(new GUI_Headline(array('text' => 'Demos', 'type' => '1')));

	$oForm		= new GUI_form(array('method' => 'post', 'action' => $_SERVER['PHP_SELF']));
	$oButton	= new GUI_FormSubmit(array('value' => 'Konfiguration speichern'));
	$oH_Action	= new GUI_FormHidden(array('name' => 'action', 'value' => 'config'));
	$oH_Page	= new GUI_FormHidden(array('name' => 'page_id', 'value' => $_VARS['page_id']));
	$oH_Element	= new GUI_FormHidden(array('name' => 'element_id', 'value' => $_VARS['element_id']));
	$oH_Content	= new GUI_FormHidden(array('name' => 'content_id', 'value' => $_VARS['content_id']));

	$aOptions = array(
		array('display' => 'Office Demo', 'value' => 'office'),
		array('display' => 'CMS Demo', 'value' => 'cms'),
	);

	$oSelect	= new GUI_FormSelect(array('name' => 'type', 'options' => $aOptions, 'selected'=>$oConfig->type));
	$oTextarea	= new GUI_FormTextarea(array('name' => 'email_text', 'value'=>$oConfig->email_text, 'style' => 'width:600px; height:300px;'));

	$oForm->appendElement(new GUI_EscapedString('<table><tr><td>Demo Modul: </td><td>'));
	$oForm->appendElement($oSelect);
	$oForm->appendElement(new GUI_EscapedString('</td></tr><tr><td>E-Mail Text: </td><td>'));
	$oForm->appendElement($oTextarea);
	$oForm->appendElement(new GUI_EscapedString('</td></tr><tr><td colspan="2" style="text-align:right;">'));
	$oForm->appendElement(new GUI_EscapedString('Platzhalter: {Username}, {Password}'));
	$oForm->appendElement(new GUI_EscapedString('</td></tr><tr><td colspan="2" style="text-align:right;">'));
	$oForm->appendElement($oButton);
	$oForm->appendElement(new GUI_EscapedString('</td></tr></table>'));
	$oForm->appendElement($oH_Action);
	$oForm->appendElement($oH_Page);
	$oForm->appendElement($oH_Element);
	$oForm->appendElement($oH_Content);

	$objPage->appendElement($oForm);
	echo $objPage->generateHTML();

}

?>