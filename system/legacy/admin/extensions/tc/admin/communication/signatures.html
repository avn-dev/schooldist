<?php

require_once(Util::getDocumentRoot()."system/legacy/admin/includes/main.inc.php");

$sGuiData = Factory::getClassName(Ext_TC_Communication_Signature_Gui2_Data::class);
$oGui = new Ext_TC_Gui2(md5('tc_communication_signatures'), $sGuiData);

$sWDBasic = Factory::getClassName(Ext_TC_SubObject::class);

$sAlias = (new $sWDBasic)->getTableAlias();

$oGui->access = array('core_communication_signatures', '');
$oGui->include_jquery = true;
$oGui->include_jquery_multiselect = true;
$oGui->query_id_alias = $sAlias;

$oGui->setWDBasic($sWDBasic);
$oGui->setTableData('limit', 30);

if(Ext_TC_Util::getSystem() === 'school') {
	$oGui->setTableData('orderby', array('ext_1' => 'ASC'));
} else {
	$oGui->setTableData('orderby', array('name' => 'ASC'));
}

$oDialog = $oGui->createDialog($oGui->t('Signatur editieren'));

$oBar = $oGui->createBar();
$oBar->width = '100%';
$oFilter = $oBar->createFilter();
$oFilter->db_column = array('name');
$oFilter->db_operator = 'LIKE';
$oFilter->id = 'search';
$oFilter->placeholder = $oGui->t('Suche').'â€¦';
$oBar->setElement($oFilter);
$oGui->setBar($oBar);

$oBar = $oGui->createBar();
$oBar->width = '100%';

$oIcon = $oBar->createEditIcon($oGui->t('Editieren'), $oDialog, $oGui->t('Editieren'));
$oBar->setElement($oIcon);

$oGui->setBar($oBar);

$oBar = $oGui->createBar();
$oBar->width = '100%';
$oBar->position = 'top';
$oPagination = $oBar->createPagination(false, true);
$oBar->setElement($oPagination);
$oLoading = $oBar->createLoadingIndicator();
$oBar->setElement($oLoading);
$oGui->setBar($oBar);

$oColumn = $oGui->createColumn();
if(Ext_TC_Util::getSystem() === 'school') {
	$oColumn->db_column = 'ext_1';
} else {
	$oColumn->db_column = 'name';
}
$oColumn->db_alias = $sAlias;
$oColumn->title = $oGui->t('Name');
$oColumn->width = 300;
$oColumn->width_resize = true;
$oGui->setColumn($oColumn);

$oGui->addDefaultColumns();

$oGui->display();