<?php
require_once(Util::getDocumentRoot()."system/legacy/admin/includes/main.inc.php");

Ext_Thebing_Access::accesschecker("thebing_admin_statisticfields");

// Daten
$aPeriodOptions		= Ext_Thebing_Management_Statistic::getPeriods(false);
$aStatisticGroups	= Ext_Thebing_Management_Statistic_Gui2::getColumnGroups();

$oGui  = new Ext_Thebing_Gui2(md5('thebing_admin_statisticfields'));
$oGui->setWDBasic('Ext_Thebing_Management_Statistic_Fields');
$oGui->setTableData('where', array('kstcd.active' => 1));
$oGui->setTableData('limit', 30);
$oGui->setTableData('orderby', array('kstcd.title' => 'ASC'));

// Listenoptionen
$oGui->column_sortable		= 1;
$oGui->row_sortable			= 0;
$oGui->multiple_selection	= 0;
$oGui->query_id_column		= 'id';
$oGui->query_id_alias		= 'kstcd';
$oGui->include_jquery				= true;
$oGui->include_jquery_multiselect	= true;

// Dialog
$oDialog			= $oGui->createDialog(L10N::t('Statistikfeld "{title}" editieren', $oGui->gui_description), L10N::t('Neuen Statistikfeld anlegen', $oGui->gui_description));
$oDialog->width		= 900;
$oDialog->height	= 400;
$oDialog->setElement($oDialog->createRow(L10N::t("Verfügbar für folgende Zeiträume", $oGui->gui_description), 'select', array('db_alias' => '','db_column' => 'period','multiple' => 5, 'jquery_multiple' => 1,'style' => 'height: 200px;','required' => 0, 'select_options'=>$aPeriodOptions)));

// Toggle
$oBar					= $oGui->createBar();
$oBar->width			= '100%';

// Suche
$oLabelGroup			= $oBar->createLabelGroup(L10N::t('Suche', $oGui->gui_description));
$oBar->setElement($oLabelGroup);
$oFilter				= $oBar->createFilter();
$oFilter->db_column		= array('title');
$oFilter->db_alias		= array('kstcd');
$oFilter->db_operator	= 'LIKE';
$oFilter->id			= 'search';
$oBar->setElement($oFilter);
$oGui->setBar($oBar);

// Kategoriefilter
$oFilter = $oBar->createFilter('select');
$oFilter->id = 'category_filter';
$oFilter->db_column		= array('group_id');
$oFilter->db_alias		= array('kstcd');
$oFilter->db_operator	= '=';
$oFilter->value = '';
$oFilter->select_options = $aStatisticGroups;
$oBar ->setElement($oFilter);

// Buttons / nur bearbeiten
$oBar			= $oGui->createBar();
$oBar->width	= '100%';

$oIcon			= $oBar->createEditIcon(L10N::t('Editieren', $oGui->gui_description), $oDialog, L10N::t('Editieren', $oGui->gui_description));
$oBar->setElement($oIcon);
$oGui->setBar($oBar);

// Paginator
$oBar			= $oGui->createBar();
$oBar->width	= '100%';
$oBar->position	= 'top';
$oPagination	= $oBar->createPagination();
$oBar->setElement($oPagination);
$oLoading		= $oBar->createLoadingIndicator();
$oBar->setElement($oLoading);
$oGui->setBar($oBar);


//Spalten
$oColumn				= $oGui->createColumn();
$oColumn->db_column		= 'title';
$oColumn->db_alias		= 'kstcd';
$oColumn->title			= L10N::t('Titel', $oGui->gui_description);
$oColumn->width			= Ext_Thebing_Util::getTableColumnWidth('name');
$oColumn->width_resize	= true;
$oGui->setColumn($oColumn);

$oColumn				= $oGui->createColumn();
$oColumn->db_column		= 'category';
$oColumn->db_alias		= '';
$oColumn->title			= L10N::t('Kategorie', $oGui->gui_description);
$oColumn->width			= Ext_Thebing_Util::getTableColumnWidth('name');
$oColumn->width_resize	= false;
$oGui->setColumn($oColumn);

$oGui->display();



?>